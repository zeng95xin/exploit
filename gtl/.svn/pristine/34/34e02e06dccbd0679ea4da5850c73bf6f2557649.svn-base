package com.test.test;

import java.io.ByteArrayOutputStream;
import java.io.IOException;
import java.io.InputStream;
import java.math.BigDecimal;
import java.net.MalformedURLException;
import java.net.URL;

import com.alibaba.fastjson.JSON;
import com.alibaba.fastjson.JSONArray;
import com.alibaba.fastjson.JSONObject;
import com.web.util.TimeUtils;

public class Test4 {

	public static void main(String[] args) {
		String timeTp = TimeUtils.getTime("yyyyMMddHHmmss");
		String stocks = "sz000517";
		//String stocks = "";
		// 统一请求接口数据
		URL u;
		try {
			u = new URL(
					"http://route.showapi.com/131-46?showapi_appid=15094"
							+ "&showapi_timestamp="
							+ timeTp
							+ "&stocks="
							+ stocks
							+ "&needIndex=1&showapi_sign=288557843a564302bcaab02569355b40");
			
			InputStream in = u.openStream();
			ByteArrayOutputStream out = new ByteArrayOutputStream();
			//System.out.println(u);
			try {
				byte buf[] = new byte[1024];
				int read = 0;
				while ((read = in.read(buf)) > 0) {
					out.write(buf, 0, read);
				}
			} finally {
				if (in != null) {
					in.close();
				}
			}
			byte b[] = out.toByteArray();
			JSONObject jsonJg = JSON.parseObject(new String(b, "utf-8")); // 将json结果转换成jsonObject
			JSONObject showBody = jsonJg.getJSONObject("showapi_res_body"); // 获取到大盘指数结果集
			JSONArray jsList = showBody.getJSONArray("list"); // 获取实时个股数组数据
			JSONObject gg_m = new JSONObject();
			gg_m=jsList.getJSONObject(0);
			String closePrice=gg_m.getString("closePrice");
			String nowPrice=gg_m.getString("nowPrice");
			BigDecimal t_closePrice=new BigDecimal(closePrice);
			BigDecimal t_nowPrice=new BigDecimal(nowPrice);
			BigDecimal t_ZDFDPrice=t_closePrice.multiply(new BigDecimal("0.1"));
			
			BigDecimal t_ZDPrice=t_closePrice.add(t_ZDFDPrice);
			BigDecimal ZDPrice=t_ZDPrice.setScale(2, BigDecimal.ROUND_HALF_UP);
			
			//System.out.println("昨天收盘价："+closePrice);
			//System.out.println("收盘价转化："+t_closePrice);
			//System.out.println("现价："+nowPrice);
			//System.out.println("现价转化："+t_nowPrice);
			//System.out.println("涨停幅度价格："+t_ZDFDPrice);
			
			//System.out.println("涨停价："+t_ZDPrice);
			//System.out.println("涨停价："+t_ZDPrice.setScale(2, BigDecimal.ROUND_HALF_UP));
			//System.out.println(ZDPrice.compareTo(t_nowPrice));
			//System.out.println(!(ZDPrice.compareTo(t_nowPrice)<0));
		} catch (MalformedURLException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		} catch (IOException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}
		
	}

}
