// JavaScript Document
var newShare= new share("showapi"); //初始化股票实时显示 API
var timer; //股票数据刷新计时器

//首页股票走势
function homeHQshow(name){
  var gp=["sh000001","sz399001","sh000300","sz399006"];
  var titleName=$("."+name+" .tab_title li");
  var conName=$("."+name+" .tab_content .li");
  var n=0;
  newShare.keyToImg(gp[0],"min","sz","img",407,265);
  for(var i=0;i<titleName.length;i++){
	  $(titleName).eq(i).attr("id",i);
	  $(titleName).eq(i).click(function(){
		  for(var j=0;j<titleName.length;j++){
			  $(titleName).eq(j).removeClass("onthis");
		  }
		  $(conName).children().remove();
		  n=$(this).attr("id");
		  $(this).addClass("onthis");
		  newShare.keyToImg(gp[n],"min","sz","img",407,265);
	  });
  }	
}

//大盘股票走势
function show5(){
	var gp=["sh000001","sz399001","sh000300","sz399006"];
  var titleName=$(".dp .tab_title li");
  var conName=$(".dp .gp_con");
  var n=0;
  newShare.keyToImg(gp[0],"min","dp_img","img",640,350);
  timer=setInterval(function(){
	  data(gp[0]);
  },5000)
  
  //newShare.keyToAllInf("",function(res){alert(JSON.stringify(res));});
  
  for(var i=0;i<titleName.length;i++){
	  $(titleName).eq(i).attr("id",i);
	  $(titleName).eq(i).click(function(){
		  for(var j=0;j<titleName.length;j++){
			  $(titleName).eq(j).removeClass("this_gp");
		  }
		  if(timer){
			 clearInterval(timer)  
		  }
		  $(conName).children().remove();
		  n=$(this).attr("id");
		  $(this).addClass("this_gp");
		  newShare.keyToImg(gp[n],"min","dp_img","img",640,350);
		  data(gp[n]);
		  timer=setInterval(function(){
			  data(gp[n]);
		  },5000)
	  });
  }	
}

//股票详情股票走势
function showgpCon(){
	var gpdm=$("#gpdm").val(); //得到股票代码
	newShare.keyToImg(gpdm,"min","gpCon_img","img",600,350);
	newShare.keyToImg(gpdm,"min","gpCon_img2","img",600,350);
	newShare.keyToImg(gpdm,"min","gpCon_img3","img",600,350);
	data(gpdm);
	timer=setInterval(function(){
		data(gpdm);
	},5000)
}

//显示相应的数据信息
function data(corder){
   newShare.keyToInflaction(corder,function(res){
	  var cont = res.cont;
	  $(".openPrice").html(cont.openPrice);
	  $(".todayMax").html(cont.todayMax);
	  $(".closePrice").html(cont.closePrice);
	  $(".todayMin").html(cont.todayMin);
	  $(".tradeNum").html((cont.tradeNum/100000000).toFixed(2));
	  $(".tradeAmount").html((cont.tradeAmount/100000000).toFixed(2));
	  console.log("corder: "+corder+"  cont.openPrice  "+new Date().getTime())
  })
	 
}



