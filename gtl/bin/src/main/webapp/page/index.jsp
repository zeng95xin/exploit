<%@ page language="java" contentType="text/html; charset=UTF-8" pageEncoding="UTF-8"%>
<%@ taglib uri="http://java.sun.com/jsp/jstl/core" prefix="c" %>
<%@ taglib prefix="fn" uri="http://java.sun.com/jsp/jstl/functions" %>
<!DOCTYPE html>
<html>
<head>
<title>股天乐</title>

<script type="text/javascript" src="jslib/jquery-1.10.1.min.js"></script>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type">
<meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, user-scalable=no,initial-scale=1" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
	<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no">
   <meta name="apple-mobile-web-app-capable" content="yes" />
   <script type="text/javascript" src="jslib/ajaxfileupload.js"></script> 
<script type="text/javascript">   

//http://blog.csdn.net/wqmain/article/details/8905287
//$(function(){
	//loadSchdCount();
	/* var url='http://192.168.12.141:8080/gtl/common/getInfo2?callback=?';
   $.ajax({
     url:url,
     dataType:'json',
     processData: false, 
     type:'get',
     success:function(data){
       console.info(data.IOS);
     },
     error:function(data, textStatus) {
       console.info(textStatus);
     }}); */
//});

//可以在本地访问接口
 function loadSchdCount(){
        	$.ajax({
                type:"post",
                dataType:"JSON",
                url:"common/getInfo?type=ad",
                success:function(data){
                	alert(data.total);         
                }
            });
 }

//$.ajaxFileUpload({  
//url:'/ajax.php',  
//fileElementId:['id1','id2']//原先是fileElementId:’id’ 只能上传一个  
//}); 
function fu(file,n){  
		var a='common/upload'+n;
		var b='fileUp'+n;
        $.ajaxFileUpload({  
            url:a,  
            secureuri:false,  
            fileElementId:b,//file标签的id  
            dataType: 'json',//返回数据的类型  
            success: function (data) {  
               $("#filename"+n).val(data.filename);
            },  
            error: function (data, status, e) {  
                alert(status);
            }  
        });  
    }; 
function fuAll(){  
		var id=["fileUp1","fileUp2","fileUp3","fileUp4"];
        $.ajaxFileUpload({  
            url:'common/uploadAll',  
            //secureuri:false,  
            fileElementId:id,//file标签的id  
            dataType: 'json',//返回数据的类型  
            success: function (data) {  
               $("#filename1").val(data.filename1);
               $("#filename2").val(data.filename2);
               $("#filename3").val(data.filename3);
               $("#filename4").val(data.filename4);
            },  
            error: function (data, status, e) {  
                alert(e);
            }  
        });  

    }
    ///fileController/upload
function fuAll1(){  
        $.ajaxFileUpload({  
            url:'fileController/upload',  
            //secureuri:false,  
           // fileElementId:id,//file标签的id  
            dataType: 'json',//返回数据的类型  
            success: function (data) {  
               $("#filename1").val(data.filename1);
               $("#filename2").val(data.filename2);
               $("#filename3").val(data.filename3);
               $("#filename4").val(data.filename4);
            },  
            error: function (data, status, e) {  
                alert(e);
            }  
        });  

    }
function fndel(n){
	var path=$("#filename"+n).val();
	$.ajax({
            type:"post",
            dataType:"JSON",
            url:"common/deleteFile?path="+path,
            success:function(data){
                 if(data.flag=="true"||data.flag==true){
                 	alert("删除成功");
                 	$("#filename"+n).val("");
                 }      
             }
       });
}
//
function fuMore(file){  
        $.ajaxFileUpload({  
            url:'common/uploadMore',  
            secureuri:false,  
            fileElementId:'fileUp',//file标签的id  
            dataType: 'json',//返回数据的类型  
            success: function (data) {  
               $("#filename5").val(data.filename);
            },  
            error: function (data, status, e) {  
                alert(status);
            }  
        });  
    }; 

</script>
</head>
<body>
<!-- multiple="multiple"实现多图同时上传的语句 -->
<input type='file' id='fileUp1' name='fileUp1' onchange="fu(this,1)" />
<!-- <input type='file' id='fileUp1' name='fileUp1' onchange="fu(this,1)"/> -->
<div id="1">
	<input type="text" id="filename1">
	<input type="button" onclick="fndel(1)" value="删除1">
</div>
<input type='file' id='fileUp2' name='fileUp2' onchange="fu(this,2)"/>
<div id="1">
	<input type="text" id="filename2">
	<input type="button" onclick="fndel(2)" value="删除2">
</div>
<input type='file' id='fileUp3' name='fileUp3' onchange="fu(this,3)"/>
<div id="1">
	<input type="text" id="filename3">
	<input type="button" onclick="fndel(3)" value="删除3">
</div>
<input type='file' id='fileUp4' name='fileUp4'  onchange="fu(this,4)"/> 
<div id="1">
	<input type="text" id="filename4" >
	<input type="button" onclick="fndel(4)" value="删除4">
</div>
<br></br>
<div>
	<span>多图同时上传</span>
	<input type='file' id='fileUp' name='fileUp'  onchange="fuMore(this)" multiple="multiple"/> 
	<textarea id="filename5" style="width: 700px;height: 300px;"></textarea>
</div> 

</body>
</html>
