<jsp:directive.page language="java" contentType="text/html; charset=UTF-8" pageEncoding="UTF-8"/>
<script type="text/javascript">
	$(function() {
		parent.$.messager.progress('close');
		$('#form').form({
			url : '${pageContext.request.contextPath}/collectionTemplateConfigController/add',
			onSubmit : function() {
				parent.$.messager.progress({
					title : '提示',
					text : '数据处理中，请稍后....'
				});
				var isValid = $(this).form('validate');
				if (!isValid) {
					parent.$.messager.progress('close');
				}
				return isValid;
			},
			success : function(result) {
				parent.$.messager.progress('close');
				result = $.parseJSON(result);
				if (result.success) {
					parent.$.modalDialog.openner_dataGrid.datagrid('reload');//之所以能在这里调用到parent.$.modalDialog.openner_treeGrid这个对象，是因为collectionTemplateConfig.jsp页面预定义好了
					parent.$.modalDialog.handler.dialog('close');
				}
			}
		});
	});
	
function fnsave(){
	
	var wzmc=$("#wzmc").val();
	var cjdz=$("#cjdz").val();
	var bt=$("#btreg").val();
	var nr=$("#nrreg").val();
	var fy=$("#fyreg").val();
	var zfj=$("#zfjreg").val();
	var id=$("#cid").val();
	if(wzmc==""||cjdz==""||bt==""||nr==""||fy==""||zfj==""){
		parent.$.messager.alert('提示','信息填写不完整！', 'info');
		return;
	}
	parent.$.messager.progress({
					title : '提示',
					text : '数据处理中，请稍后....'
				});
	var url=encodeURI(encodeURI('${pageContext.request.contextPath}/collectionTemplateConfigController/edit?id='+id+'&wzmc='+wzmc+'&cjdz='+cjdz+'&bt='+bt+'&nr='+nr+'&fy='+fy+'&zfj='+zfj+'&callback=?'));
   $.ajax({
     url:url,
     dataType:'json',
     processData: false, 
     type:'get',
     success:function(data){
     	parent.$.messager.progress('close');
		if (data.success) {
			parent.$.messager.alert('提示','保存成功！', 'info');
			parent.$.modalDialog.openner_dataGrid.datagrid('reload');
			parent.$.modalDialog.handler.dialog('close');
		}     
     },
     error:function(data, textStatus) {
       console.info(textStatus);
     }});
 
}
</script>
<div class="easyui-layout" data-options="fit:true,border:false">
	<div data-options="region:'center',border:false" title="" style="overflow: hidden;">
		<form id="form" method="post">
			<table class="table table-hover table-condensed">
				<tr>
					<th style="text-align: right;width: 120px;">网站名称</th>
					<td><input name="id" id="cid" type="hidden" value="${collectionTemplateConfig.id}"/><input id="wzmc" name="wzmc" type="text" style="width: 210px;" placeholder="请输入网站名称" class="easyui-validatebox span2" data-options="required:true" value="${collectionTemplateConfig.wzmc}"/></td>
				</tr>
				<tr>
					<th style="text-align: right;width: 120px;">采集地址</th>
					<td><input name="cjdz" id="cjdz" type="text" style="width: 210px;" class="easyui-validatebox span2" data-options="required:true" value="${collectionTemplateConfig.cjdz}"/></td>
				</tr>
				<tr>
					<th style="text-align: right;width: 120px;">标题特征码</th>
					<td><input name="btreg" id="btreg" type="text" style="width: 210px;" class="easyui-validatebox span2" data-options="required:true" value="${collectionTemplateConfig.btreg}"/></td>
				</tr>
				<tr>
					<th style="text-align: right;width: 120px;">内容特征码</th>
					<td><input name="nrreg" id="nrreg" type="text" style="width: 210px;" class="easyui-validatebox span2" data-options="required:true" value="${collectionTemplateConfig.nrreg}"/></td>
				</tr>
				<tr>
					<th style="text-align: right;width: 120px;">内容分页特征码</th>
					<td><input name="fyreg" id="fyreg" type="text" style="width: 210px;" class="easyui-validatebox span2" data-options="required:true" value="${collectionTemplateConfig.fyreg}"/></td>
				</tr>
				<tr>
					<th style="text-align: right;width: 120px;">网站字符集编码</th>
					<td><input name="zfjreg" id="zfjreg" type="text" style="width: 210px;" class="easyui-validatebox span2" data-options="required:true" value="${collectionTemplateConfig.zfjreg}"/></td>
				</tr> 
				<tr>
					<td colspan="3" style="text-align: center;">
						<input type="button" value="保存" onclick="fnsave()" id="btn_1"/>
					</td>
				</tr>
			</table>
		</form>
	</div>
</div>