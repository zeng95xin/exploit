<%@ page language="java" contentType="text/html; charset=UTF-8" pageEncoding="UTF-8"%>
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core"%>
<script type="text/javascript">
	$(function() {
	
	
	
		parent.$.messager.progress('close');
		
		$('#form').form({
			url : '${pageContext.request.contextPath}/newsController/zhuanyi',
			onSubmit : function() {
				parent.$.messager.progress({
					title : '提示',
					text : '数据处理中，请稍后....'
				});
				var isValid = $(this).form('validate');
				if (!isValid) {
					parent.$.messager.progress('close');
				}
				return isValid;
			},
			success : function(result) {
				parent.$.messager.progress('close');
				result = $.parseJSON(result);
				if (result.success) {
					parent.$.modalDialog.openner_dataGrid.datagrid('reload');//之所以能在这里调用到parent.$.modalDialog.openner_dataGrid这个对象，是因为user.jsp页面预定义好了
					parent.$.modalDialog.handler.dialog('close');
				} else {
					parent.$.messager.alert('错误', result.msg, 'error');
				}
			}
		});
	});
	
	function fileManage() {
		editor.loadPlugin('filemanager', function() {
			editor.plugin.filemanagerDialog({
				viewType : 'VIEW',
				dirName : 'image',
				clickFn : function(url, title) {
					//KindEditor('#url').val(url);
					alert(url);
					editor.insertHtml($.formatString('<img src="{0}" alt="" />', url));
					editor.hideDialog();
				}
			});
		});
	}
	
	function fnc(){
		var a=$("#zt").val();
		if(a=="gxt"){
			$("#gxtfl").css("display","block");
			$("#gqbfl").css("display","none");
			$("#xwxfl").css("display","none");
		}else if(a=="xwx"){
			$("#xwxfl").css("display","block");
			$("#gxtfl").css("display","none");
			$("#gqbfl").css("display","none");
		}else if(a=="gqb"){
			$("#gqbfl").css("display","block");
			$("#gxtfl").css("display","none");
			$("#xwxfl").css("display","none");
		}else{
			$("#gxtfl").css("display","none");
			$("#gqbfl").css("display","none");
			$("#xwxfl").css("display","none");
		}
	}

function save(){
	var ids=$("#ids").val();
	var zt=$("#zt").val();
	var xwxfl=$("#xwxfl").val();
	var gxtfl=$("#gxtfl").val();
	var gqbfl=$("#gqbfl").val();
	var a=$("#zt").val();
	if(a=="gxt"){
		if(gxtfl==""){
			parent.$.messager.alert('提示', '请选择分类', 'info');
			return;
		}
	}else if(a=="xwx"){
		if(xwxfl==""){
			parent.$.messager.alert('提示', '请选择分类', 'info');
			return;
		}	
	}else if(a=="gqb"){
		if(gqbfl==""){
			parent.$.messager.alert('提示', '请选择分类', 'info');
			return;
		}	
	}else{
		parent.$.messager.alert('提示', '请选择分类', 'info');
		return;
	}
	$.post('${pageContext.request.contextPath}/newsController/zhuanyi', {
						ids : ids,zt:zt,xwxfl:xwxfl,gxtfl:gxtfl,gqbfl:gqbfl
					}, function(result) {
						if (result.success) {
							parent.$.messager.alert('提示', result.msg, 'info');
							dataGrid.datagrid('reload');
						}
						parent.$.messager.progress('close');
					}, 'JSON');
}
</script>
<div class="easyui-layout" data-options="fit:true,border:false">
	<div data-options="region:'center',border:false" title="" style="overflow: hidden;">
		<form id="form" method="post">
			<table class="table table-hover table-condensed">
				<tr>
					<th>需要转移的编号</th>
					<td colspan="3">
						<textarea name="ids" id="ids">${ids }</textarea>
					</td>
				</tr>
				<tr>
					<th>转移到文章的类型</th>
					<td colspan="3">
						<select id="zt" onchange="fnc()">
							<option value="xwx">新闻线</option>
							<option value="gxt">股学堂</option>
							<option value="gqb">股趣吧</option>
						</select>
						
						<select id="xwxfl">
							<option value="1">独家重磅</option>
							<option value="2">新闻纵深</option>
							<option value="3">热股探析</option>
							<option value="4">股往金来</option>
						</select>
						
						<select id="gqbfl" style="display: none;">
							<option value="1">股市段子</option>
							<option value="2">甘甜股事</option>
							<option value="3">股道情歌 </option>
							<option value="4">趣味小图</option>
							<option value="5">有趣视频</option>
						</select>
						
						<select id="gxtfl" style="display: none;">
							<option value="0">憨豆评股</option>
							<option value="1">草根教师</option>
							<option value="2">教授讲堂</option>
						</select>
					</td>
				</tr>
				<tr>
					<td colspan="4" style="text-align: center;">
						<input type="button" value="保存" onclick="save()">
					</td>
				</tr>
			</table>
		</form>
	</div>
</div>